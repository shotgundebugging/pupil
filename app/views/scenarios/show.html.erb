
<h1><%= @scenario.name %></h1>

<p><%= simple_format(@scenario.description) %></p>

<% if @scenario.rgb_video.attached? || @scenario.depth_video.attached? %>
  <div
    data-controller="synced-videos"
    data-synced-videos-fps-value="30">

    <div style="margin: 1rem 0;">
      <button type="button"
              data-synced-videos-target="playPause"
              data-action="click->synced-videos#togglePlay">
        Play
      </button>
      <input type="range"
             value="0"
             min="0"
             step="0.01"
             style="width: 400px; vertical-align: middle;"
             data-synced-videos-target="scrubber"
             data-action="input->synced-videos#scrub">
      <span style="margin-left: .5rem;">
        Time:
        <span data-synced-videos-target="timeDisplay"></span>
        |
        <span data-synced-videos-target="frameDisplay"></span>
      </span>
    </div>

    <div style="display: flex; gap: 1rem; align-items: flex-start;">
      <div style="flex: 1;">
        <% if @scenario.rgb_video.attached? %>
          <h2>RGB video</h2>
          <video
            data-synced-videos-target="rgb"
            width="424"
            height="240">
            <source src="<%= url_for(@scenario.rgb_video) %>" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        <% else %>
          <p>No RGB video uploaded for this scenario.</p>
        <% end %>
      </div>

      <div style="flex: 1;">
        <% if @scenario.depth_video.attached? %>
          <h2>Depth video</h2>
          <video
            data-synced-videos-target="depth"
            width="424" height="240">
            <source src="<%= url_for(@scenario.depth_video) %>" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        <% else %>
          <p>No depth video uploaded for this scenario.</p>
        <% end %>
      </div>
    </div>
  </div>
<% else %>
  <p>No videos uploaded for this scenario.</p>
<% end %>

<hr class="my-4">

<div data-controller="annotations">
  <h2>Annotation canvas (RGB frame snapshot area)</h2>
  <canvas
    data-annotations-target="canvas"
    width="848"
    height="480"
    style="border: 1px solid #ccc;">
  </canvas>
</div>

<h2 class="mt-6">Annotations</h2>

<% if @scenario.annotations.any? %>
  <div>
    <%= render @scenario.annotations %>
  </div>
<% else %>
  <p>No annotations yet.</p>
<% end %>

<p>
  <%= link_to "Back to scenarios", scenarios_path %>
</p>
